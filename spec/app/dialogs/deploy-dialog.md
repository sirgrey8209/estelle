# Deploy Dialog

> ë°°í¬ ë‹¤ì´ì–¼ë¡œê·¸

## ìœ„ì¹˜

`lib/ui/widgets/deploy/deploy_dialog.dart`

---

## ì—­í• 

- ì£¼ë„ Pylon ì„ íƒ
- ë¹Œë“œ ì§„í–‰ ìƒíƒœ í‘œì‹œ
- ì‚¬ì „ ìŠ¹ì¸ / ìŠ¹ì¸ í† ê¸€
- ë°°í¬ ì‹¤í–‰

---

## ë°°í¬ ë‹¨ê³„ (DeployPhase)

| Phase | ì„¤ëª… | ë‹¤ìŒ ë‹¨ê³„ |
|-------|------|----------|
| `idle` | ì´ˆê¸°: Pylon ì„ íƒ | â†’ building |
| `building` | ë¹Œë“œ ì¤‘ (ì‚¬ì „ ìŠ¹ì¸ ê°€ëŠ¥) | â†’ buildReady / error |
| `buildReady` | ë¹Œë“œ ì™„ë£Œ, ìŠ¹ì¸ ëŒ€ê¸° | â†’ preparing / ready |
| `preparing` | ë‹¤ë¥¸ Pylon ì¤€ë¹„ ì¤‘ | â†’ ready |
| `ready` | ëª¨ë“  ì¤€ë¹„ ì™„ë£Œ, GO ëŒ€ê¸° | â†’ deploying |
| `deploying` | ë°°í¬ ì‹¤í–‰ ì¤‘ | ì™„ë£Œ í›„ ë‹¤ì´ì–¼ë¡œê·¸ ë‹«í˜ |
| `error` | ì˜¤ë¥˜ ë°œìƒ | â†’ building (ì¬ì‹œë„) |

---

## ìƒíƒœ (State)

| ìƒíƒœ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `_phase` | `DeployPhase` | í˜„ì¬ ë°°í¬ ë‹¨ê³„ |
| `_statusMessage` | `String` | ìƒíƒœ ë©”ì‹œì§€ |
| `_errorMessage` | `String?` | ì—ëŸ¬ ë©”ì‹œì§€ |
| `_selectedPylonId` | `int?` | ì„ íƒëœ Pylon ID |
| `_confirmed` | `bool` | ìŠ¹ì¸ ì—¬ë¶€ (í† ê¸€) |
| `_buildTasks` | `Map<String, String>` | ë¹Œë“œ íƒœìŠ¤í¬ ìƒíƒœ |
| `_commitHash` | `String?` | ë¹Œë“œëœ ì»¤ë°‹ í•´ì‹œ |
| `_version` | `String?` | ë¹Œë“œëœ ë²„ì „ |
| `_pylonAckCount` | `int` | ì¤€ë¹„ëœ Pylon ìˆ˜ |
| `_startTime` | `DateTime?` | ë¹Œë“œ ì‹œì‘ ì‹œê°„ |
| `_estimatedSeconds` | `int` | ì˜ˆìƒ ì†Œìš” ì‹œê°„ (ì´ˆ) |

---

## êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš€ ë°°í¬                                â”‚  â† Title
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì£¼ë„ Pylon ì„ íƒ:                       â”‚
â”‚  â—‹ ğŸŒ™ Selene (Device ID: 1)            â”‚  â† RadioListTile
â”‚  â— â­ Stella (Device ID: 2)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ë¹Œë“œ ìƒíƒœ                        â”‚   â”‚
â”‚  â”‚ âœ“GIT âŸ³APK â—‹EXE â—‹NPM â—‹JSON      â”‚   â”‚  â† Build tasks
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚
â”‚  ë¹Œë“œ ì¤‘...                             â”‚  â† Status message
â”‚  v1.2.3 (abc1234)                      â”‚  â† Version info
â”‚  ì¤€ë¹„ëœ Pylon: 2                        â”‚  â† Ack count
â”‚                                        â”‚
â”‚  ğŸ’¡ ë¹Œë“œ ì™„ë£Œ ì „ì— ë¯¸ë¦¬ ìŠ¹ì¸í•˜ë©´...      â”‚  â† Pre-approve tip
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        [ì·¨ì†Œ]  [ë¯¸ë¦¬ ìŠ¹ì¸]  [ë°°í¬ ì‹œì‘]  â”‚  â† Buttons
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë¹Œë“œ íƒœìŠ¤í¬ ìƒíƒœ

| íƒœìŠ¤í¬ | ì„¤ëª… |
|--------|------|
| `git` | Git ì»¤ë°‹/íƒœê·¸ |
| `apk` | Android APK ë¹Œë“œ |
| `exe` | Windows EXE ë¹Œë“œ |
| `npm` | NPM íŒ¨í‚¤ì§€ |
| `json` | deploy.json ìƒì„± |

### íƒœìŠ¤í¬ ìƒíƒœë³„ í‘œì‹œ

| ìƒíƒœ | ì•„ì´ì½˜ | ìƒ‰ìƒ |
|------|--------|------|
| `done` | âœ“ check_circle | `nord14` (green) |
| `error` | âœ— error | `nord11` (red) |
| `waiting` | â—· schedule | `nord4` (gray) |
| ì§„í–‰ ì¤‘ | âŸ³ sync | `nord13` (yellow) |

---

## ë²„íŠ¼ ìƒíƒœ

### idle

| ë²„íŠ¼ | í™œì„±í™” ì¡°ê±´ |
|------|-------------|
| ë°°í¬ ì‹œì‘ | Pylon ì„ íƒë¨ |
| ì·¨ì†Œ | í•­ìƒ |

### building / buildReady

| ë²„íŠ¼ | í…ìŠ¤íŠ¸ | ìƒ‰ìƒ |
|------|--------|------|
| ìŠ¹ì¸ (ë¯¸ìŠ¹ì¸) | "ë¯¸ë¦¬ ìŠ¹ì¸" / "ìŠ¹ì¸" | `nord10` |
| ìŠ¹ì¸ (ìŠ¹ì¸ë¨) | "ìŠ¹ì¸ ì·¨ì†Œ" | `nord12` |

### ready

| ë²„íŠ¼ | í…ìŠ¤íŠ¸ | ìƒ‰ìƒ |
|------|--------|------|
| GO | "GO" | `nord14` (bold) |

### deploying / preparing

| ë²„íŠ¼ | í‘œì‹œ |
|------|------|
| - | CircularProgressIndicator |

### error

| ë²„íŠ¼ | í…ìŠ¤íŠ¸ | ìƒ‰ìƒ |
|------|--------|------|
| ì¬ì‹œë„ | "ì¬ì‹œë„" | `nord12` |

---

## ë©”ì‹œì§€ í•¸ë“¤ë§

| ë©”ì‹œì§€ íƒ€ì… | ì²˜ë¦¬ |
|-------------|------|
| `deploy_status` | ë¹Œë“œ íƒœìŠ¤í¬ ìƒíƒœ ì—…ë°ì´íŠ¸ |
| `deploy_ready` | ë¹Œë“œ ì™„ë£Œ â†’ buildReady |
| `deploy_ack_received` | Pylon ack ì¹´ìš´íŠ¸ ì¦ê°€ |
| `deploy_restarting` | deploying ìƒíƒœë¡œ ì „í™˜ |
| `deploy_error` | error ìƒíƒœë¡œ ì „í™˜ |

---

## ë¹Œë“œ ì‹œê°„ í†µê³„

- `SharedPreferences`ì— ìµœê·¼ 5íšŒ ë¹Œë“œ ì‹œê°„ ì €ì¥
- í‰ê· ê°’ìœ¼ë¡œ ì˜ˆìƒ ì‹œê°„ ê³„ì‚°

---

## UI ìŠ¤í™

### í¬ê¸°

| ìš”ì†Œ | ê°’ |
|------|-----|
| ì»¨í…ì¸  ë„ˆë¹„ | 400px |

### ìƒ‰ìƒ

| ìš”ì†Œ | ìƒ‰ìƒ |
|------|------|
| ë°°ê²½ | `nord1` |
| íƒ€ì´í‹€ í…ìŠ¤íŠ¸ | `nord5` |
| íƒ€ì´í‹€ ì•„ì´ì½˜ | `nord13` |
| ìƒíƒœ ë©”ì‹œì§€ (ê¸°ë³¸) | `nord4` |
| ìƒíƒœ ë©”ì‹œì§€ (ì—ëŸ¬) | `nord11` |
| ìƒíƒœ ë©”ì‹œì§€ (ì¤€ë¹„ ì™„ë£Œ) | `nord14` |
| ë¹Œë“œ íƒœìŠ¤í¬ ë°°ê²½ | `nord0` |
| ì—ëŸ¬ ë°•ìŠ¤ ë°°ê²½ | `nord11` 20% |
| íŒ ë°•ìŠ¤ ë°°ê²½ | `nord10` 20% |

---

## ê´€ë ¨ ë¬¸ì„œ

- [settings-screen.md](./settings-screen.md) - ì„¤ì • í™”ë©´
- [../../pylon/overview.md](../../pylon/overview.md) - Pylon ê°œìš”
- [../../system/message-protocol.md](../../system/message-protocol.md) - ë©”ì‹œì§€ í”„ë¡œí† ì½œ
